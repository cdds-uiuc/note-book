

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>3. Simulating discrete stochastic processes &#8212; Climate Dynamics and Data Science Notes</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="../../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'content/Hasselmann/3_Simulating_Stochastic_Processes';</script>
    <link rel="canonical" href="https://cdds-uiuc.github.io/simles-book/content/Hasselmann/3_Simulating_Stochastic_Processes.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="4. Theoretical Solutions" href="4_Theory.html" />
    <link rel="prev" title="2. The Hasselmann model" href="2_Hasselmann_model.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/CDDS_logo.png" class="logo__image only-light" alt="Climate Dynamics and Data Science Notes - Home"/>
    <script>document.write(`<img src="../../_static/CDDS_logo.png" class="logo__image only-dark" alt="Climate Dynamics and Data Science Notes - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    CDDS Notes
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="Hasselmann.html">The Hasselmann model</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="1_Mathematical_Prelims.html">1. Mathematical Preliminaries</a></li>
<li class="toctree-l2"><a class="reference internal" href="2_Hasselmann_model.html">2. The Hasselmann model</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">3. Simulating discrete stochastic processes</a></li>
<li class="toctree-l2"><a class="reference internal" href="4_Theory.html">4. Theoretical Solutions</a></li>
</ul>
</li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/cdds-uiuc/note-book/master?urlpath=lab/tree/content/Hasselmann/3_Simulating_Stochastic_Processes.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onBinder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li><a href="https://colab.research.google.com/github/cdds-uiuc/note-book/blob/master/content/Hasselmann/3_Simulating_Stochastic_Processes.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onColab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/cdds-uiuc/note-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/cdds-uiuc/note-book/issues/new?title=Issue%20on%20page%20%2Fcontent/Hasselmann/3_Simulating_Stochastic_Processes.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/content/Hasselmann/3_Simulating_Stochastic_Processes.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>3. Simulating discrete stochastic processes</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-problem-with-continuous-white-noise">The problem with continuous white noise</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#nyquist-frequency-and-a-truncated-white-noise-spectrum">Nyquist frequency and a truncated white noise spectrum:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#setting-the-variance-in-a-simulation-fixing-spetral-density-tilde-s-f">Setting the variance in a simulation: Fixing spetral density <span class="math notranslate nohighlight">\(\tilde s_F\)</span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alternatives">Alternatives</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fixing-sigma-f-delta-t-is-sampling-time">Fixing <span class="math notranslate nohighlight">\(\sigma_{F}\)</span> (<span class="math notranslate nohighlight">\(\Delta t\)</span> is sampling time)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#small-delta-t-then-averaging">Small <span class="math notranslate nohighlight">\(\Delta t\)</span> then averaging</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="simulating-discrete-stochastic-processes">
<h1>3. Simulating discrete stochastic processes<a class="headerlink" href="#simulating-discrete-stochastic-processes" title="Permalink to this heading">#</a></h1>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">stats</span>

<span class="k">if</span> <span class="s1">&#39;google.colab&#39;</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">get_ipython</span><span class="p">()):</span>
  <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Running on CoLab, need to install multitaper&#39;</span><span class="p">)</span>
  <span class="o">%</span><span class="k">pip</span> install multitaper

<span class="kn">from</span> <span class="nn">multitaper</span> <span class="kn">import</span> <span class="n">mtspec</span>

<span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;legend.fontsize&#39;</span><span class="p">:</span> <span class="s1">&#39;x-large&#39;</span><span class="p">,</span>
          <span class="s1">&#39;figure.figsize&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span>
          <span class="s1">&#39;axes.labelsize&#39;</span><span class="p">:</span> <span class="s1">&#39;x-large&#39;</span><span class="p">,</span>
         <span class="s1">&#39;axes.titlesize&#39;</span><span class="p">:</span><span class="s1">&#39;x-large&#39;</span><span class="p">,</span>
         <span class="s1">&#39;xtick.labelsize&#39;</span><span class="p">:</span><span class="s1">&#39;x-large&#39;</span><span class="p">,</span>
         <span class="s1">&#39;ytick.labelsize&#39;</span><span class="p">:</span><span class="s1">&#39;x-large&#39;</span><span class="p">}</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<section id="the-problem-with-continuous-white-noise">
<h2>The problem with continuous white noise<a class="headerlink" href="#the-problem-with-continuous-white-noise" title="Permalink to this heading">#</a></h2>
<p>Before we can go ahead and solve theoretically for the spectrum of
a Hasselmann model we need to deal with one more issue: How do we
set the variance of the stochastic forcing <span class="math notranslate nohighlight">\(F(t)\)</span>? One has to be
very careful when modeling discretized stochastic processes as the
amount of variance may change when changing the time-step and the
length of the time interval considered. The problem is that there
is no well-defined continuous version of a white noise process.
Parseval’s theorem illustrates the issue: if a white noise process
<span class="math notranslate nohighlight">\(F(t)\)</span> has a constant spectral density <span class="math notranslate nohighlight">\(\tilde{s}_{F}^{2}\)</span>, its variance would become infinite.</p>
<div class="math notranslate nohighlight">
\[
var(F)=\int_{-\infty}^{\infty}\tilde{s}_{F}^{2}df=\tilde{s}_{F}^{2}\int_{-\infty}^{\infty}df=\infty
\]</div>
<p>In reality white noise is not truly white at all frequencies. i.e.
it does not have a constant spectral density at all frequency. At
high enough frequency, the spectrum of the forcing does go down. This
is indeed Hasselmann’s assumption; that the forcing is white at time-scales
longer than a given timescale <span class="math notranslate nohighlight">\(\tau_{w}\)</span> (i.e. frequencies lower
than a frequency <span class="math notranslate nohighlight">\(f_{w}\)</span>). For example, if we were to assume weather
forcing <span class="math notranslate nohighlight">\(F\)</span> was ‘white’ up to hourly time-scales it would mean
that weather is not correlated between this hour and the next hour.
In reality, weather is only uncorrelated (or, `white’) at timescales
longer than <span class="math notranslate nohighlight">\(\sim 2\)</span> weeks.</p>
<p><strong>Side note:</strong> White noise can informally defined as the time-derivative
of a <a class="reference external" href="https://en.wikipedia.org/wiki/Wiener_process">Wiener process</a> <span class="math notranslate nohighlight">\(F=dW/dt\)</span>, but I’ve been told that is not something mathematicians look kindly upon. If we want to stay in the time-domain, one option is to model the Hasselmann equation as an <a class="reference external" href="https://en.wikipedia.org/wiki/Ornstein%E2%80%93Uhlenbeck_process">Ornstein–Uhlenbeck Process</a>:</p>
<div class="math notranslate nohighlight">
\[
dT=\tau_{0}^{-1}Tdt+\lambda^{-1}dW(t)
\]</div>
<p>where the ill-defined <span class="math notranslate nohighlight">\(Fdt\)</span> is replaced by the well defined Wiener
process <span class="math notranslate nohighlight">\(dW\)</span>, a continuous version of the random walk. The problem
is that once we move passed the simple one-dimensional Hasselmann
model into more complex linear systems with more than one state variable
and more than one forcing, things become messy. Also, it may be the
case that the forcing term cannot be assumed to be white, which is
the case in the tropics.</p>
</section>
<section id="nyquist-frequency-and-a-truncated-white-noise-spectrum">
<h2>Nyquist frequency and a truncated white noise spectrum:<a class="headerlink" href="#nyquist-frequency-and-a-truncated-white-noise-spectrum" title="Permalink to this heading">#</a></h2>
<p>For a dataset sampled discretely at time intervals <span class="math notranslate nohighlight">\(\Delta t\)</span> (which
is every dataset that we can measure or simulate) Nyquist-Snannon sampling theorem
tells us that we can only estimate the spectrum between frequencies <span class="math notranslate nohighlight">\(-f_{N}\)</span> and <span class="math notranslate nohighlight">\(f_{N}\)</span> where the Nyquist frequncy is</p>
<div class="math notranslate nohighlight">
\[
f_{N}=\frac{1}{2\Delta t}. 
\]</div>
<p>More than that, the sampling theorem tells us that if there is spectral
power at frequencies <span class="math notranslate nohighlight">\(\left|f\right|&gt;f_{N}\)</span> than this power will be aliased at frequencies smaller than the sampling frequency <span class="math notranslate nohighlight">\(\left|f\right|&lt;f_{N}\)</span> and thus bias our estimate of the variance in this range.</p>
<p>Thus, the preferred option for simulating a Hasselmann model is to
fix the spectral density of the forcing <span class="math notranslate nohighlight">\(F(t)\)</span>, and assume it is
zero outside the Nyquist frequency <span class="math notranslate nohighlight">\(f_{N}\)</span>.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
S_{FF}\left(f\right)=\begin{cases}
\tilde{s}_{F}^{2} &amp; \text{if }f\in\left[-f_{N};f_{N}\right]\\
0 &amp; \text{otherwise}
\end{cases}
\end{split}\]</div>
<p>This both helps avoid the aliasing issue and also accounts for the
fact that Forcing spectrum is not truly white up to infinitely high
frequency. In this case, the variance of the discrete time-series
<span class="math notranslate nohighlight">\(F_{n}=F(t_{n})\)</span> can be reconstructed as:</p>
<div class="math notranslate nohighlight">
\[
\text{var}\left(F\right)=\sigma_{F}^{2}=C_{FF}\left(0\right)=\int_{-\infty}^{\infty}S_{FF}(f)df=\int_{-f_{N}}^{f_{N}}\tilde{s}_{F}^{2}df=\tilde{s}_{F}^{2}\cdot2f_{N}=\tilde{s}_{F}^{2}\cdot2\frac{1}{2\Delta t}
\]</div>
<div class="math notranslate nohighlight">
\[
\boxed{\sigma_{F}^{2}=\frac{\tilde{s}_{F}^{2}}{\Delta t}}
\]</div>
</section>
<section id="setting-the-variance-in-a-simulation-fixing-spetral-density-tilde-s-f">
<h2>Setting the variance in a simulation: Fixing spetral density <span class="math notranslate nohighlight">\(\tilde s_F\)</span><a class="headerlink" href="#setting-the-variance-in-a-simulation-fixing-spetral-density-tilde-s-f" title="Permalink to this heading">#</a></h2>
<p>When simulating a Hasselmann model discretely, we need to set the
variance of the discretized forcing vector <span class="math notranslate nohighlight">\(F_{n}\)</span>.</p>
<p><em><strong>IF</strong></em> we want the
process to have the same process spectra regardless of sampling interval
or length, we need to to rescale the variance we impose on <span class="math notranslate nohighlight">\(F_{n}\)</span>
by <span class="math notranslate nohighlight">\(1/\Delta t\)</span>. In practice, that means that we would fix
a value for <span class="math notranslate nohighlight">\(\tilde{s}_{F}\)</span> and then draw a random vector <span class="math notranslate nohighlight">\(F_{n}\)</span>
that has standard deviation <span class="math notranslate nohighlight">\(\sigma_{F}=\tilde{s}_{F}/\sqrt{\Delta t}\)</span>.
This way, the spectral quantities that we try to estimate, such as the power-spectral density of <span class="math notranslate nohighlight">\(F\)</span> and temperature <span class="math notranslate nohighlight">\(T\)</span>, do not depend
on our choice of numerical discretization.</p>
<p>The figure below shows three simulations of a white noise process with the same <em>process</em> variance density <span class="math notranslate nohighlight">\(\tilde s_F^2=1\)</span>. Note that because we are only simulating a short interval the estimated spectral density of the sample varies around 1. Also note that we are only plotting positive frequencies.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## </span>

<span class="c1"># Fix the Spectral Variance Density sf^2</span>
<span class="n">specdens</span><span class="o">=</span><span class="mf">1.5</span><span class="p">;</span>

<span class="c1"># A vector of three different sampling intervals</span>
<span class="n">dt_vec</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">10</span><span class="p">]</span>

<span class="c1"># Total Simulation time</span>
<span class="n">T_total</span><span class="o">=</span><span class="mi">7</span><span class="o">*</span><span class="mi">4</span><span class="o">*</span><span class="mi">20</span><span class="p">;</span>

<span class="c1">#set up figure</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">16</span><span class="p">,</span><span class="mi">8</span><span class="p">])</span>

<span class="k">for</span> <span class="n">i_dt</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    
    <span class="c1">#sampling interval</span>
    <span class="n">dt</span><span class="o">=</span><span class="n">dt_vec</span><span class="p">[</span><span class="n">i_dt</span><span class="p">]</span>
    <span class="c1">#time vector</span>
    <span class="n">t</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">T_total</span><span class="p">,</span><span class="n">dt</span><span class="p">)</span>
    
    <span class="c1">#total number of points:</span>
    <span class="n">N</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">T_total</span><span class="o">/</span><span class="n">dt</span><span class="p">);</span>

    <span class="c1"># normalize density of F by \sqrt(dt). Not that spec</span>
    <span class="n">var_F</span><span class="o">=</span><span class="n">specdens</span><span class="o">/</span><span class="n">dt</span>
    <span class="n">sigma_F</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">var_F</span><span class="p">)</span>
    
    <span class="c1">#simulate a white noise process:</span>
    <span class="n">F</span><span class="o">=</span><span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">scale</span><span class="o">=</span><span class="n">sigma_F</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="n">N</span><span class="p">);</span>

    <span class="c1">#compute the spectrum</span>
    <span class="n">out</span><span class="o">=</span><span class="n">mtspec</span><span class="o">.</span><span class="n">MTSpec</span><span class="p">(</span><span class="n">F</span><span class="p">,</span><span class="n">nw</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span><span class="n">kspec</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">iadapt</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">freq</span><span class="o">=</span><span class="n">out</span><span class="o">.</span><span class="n">freq</span>
    <span class="n">S_FF</span> <span class="o">=</span><span class="n">out</span><span class="o">.</span><span class="n">spec</span>
    <span class="n">S_FF</span><span class="o">=</span><span class="n">S_FF</span><span class="p">[</span><span class="n">freq</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">freq</span><span class="o">=</span><span class="n">freq</span><span class="p">[</span><span class="n">freq</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">]</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">i_dt</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">F</span><span class="p">,</span><span class="s1">&#39;.-&#39;</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;var$(F)$=&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">F</span><span class="p">),</span><span class="mi">2</span><span class="p">)))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;time [yrs]&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;F&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
    

    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">i_dt</span><span class="o">+</span><span class="mi">4</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freq</span><span class="p">,</span><span class="n">S_FF</span><span class="p">,</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="n">specdens</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">freq</span><span class="p">),</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;process density $S_</span><span class="si">{FF}</span><span class="s1">=$&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">specdens</span><span class="p">))</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;var$(X)=\int_{-f_N}^</span><span class="si">{f_N}</span><span class="s1"> S_</span><span class="si">{FF}</span><span class="s1">df=$ &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">F</span><span class="p">),</span><span class="mi">2</span><span class="p">)))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$S_</span><span class="si">{FF}</span><span class="s1">$&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$f\; [1/yr]$&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/783e1bade6d885a9402e8a9e1f8342dbe3dbc7f8cd645464de7ca73254f55c40.png" src="../../_images/783e1bade6d885a9402e8a9e1f8342dbe3dbc7f8cd645464de7ca73254f55c40.png" />
</div>
</div>
</section>
<section id="alternatives">
<h2>Alternatives<a class="headerlink" href="#alternatives" title="Permalink to this heading">#</a></h2>
<p>There are a few other alternatives for setting the variance of <span class="math notranslate nohighlight">\(F_n\)</span>.</p>
<section id="fixing-sigma-f-delta-t-is-sampling-time">
<h3>Fixing <span class="math notranslate nohighlight">\(\sigma_{F}\)</span> (<span class="math notranslate nohighlight">\(\Delta t\)</span> is sampling time)<a class="headerlink" href="#fixing-sigma-f-delta-t-is-sampling-time" title="Permalink to this heading">#</a></h3>
<p>A second option for simulating a Hasselmann model is to set <span class="math notranslate nohighlight">\(\sigma_{F}\)</span>,
i.e the variance of the time-domain vector <span class="math notranslate nohighlight">\(F(t_{n})\)</span>. This might
seem the easiest approach, since <span class="math notranslate nohighlight">\(\sigma_{F}\)</span> is what we actually
provide python when drawing samples from a random vector. However,
in this scenario, the spectral density of <span class="math notranslate nohighlight">\(F\)</span> will change if we change
<span class="math notranslate nohighlight">\(\Delta t\)</span>.</p>
<p>A scenario where a white noise process has the same variance regardless
of time-step is (more-or-less) equivalent to plucking data points
at a time-step <span class="math notranslate nohighlight">\(\Delta t\)</span>. For example, if we compare a dataset with
<span class="math notranslate nohighlight">\(\Delta t=1\)</span> day and one with <span class="math notranslate nohighlight">\(\Delta t=1\)</span> month and they have the
same variance, this is as if the data that is collected every month
is actually just daily data collected only day per month.</p>
<p>In this case, the power spectral density we would estimate for <span class="math notranslate nohighlight">\(F\)</span>
is <span class="math notranslate nohighlight">\(\hat{\tilde{s}}_{F}^{2}=\sigma_{F}^{2}\Delta t\)</span>. So as we increase
the time-step, we would get higher spectral densities. This increase in power spectral density can be interpretated as arising from the fact that the spectral power at frequencies higher than the highest accessible frequency <span class="math notranslate nohighlight">\(f_{N}\)</span> is getting aliased back into our spectral estimate between <span class="math notranslate nohighlight">\(-f_{N}\)</span> and <span class="math notranslate nohighlight">\(f_{N}\)</span></p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># A vector of three different sampling intervals</span>
<span class="n">dt_vec</span><span class="o">=</span><span class="p">[</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">0.5</span><span class="p">]</span>

<span class="c1"># Total Simulation time</span>
<span class="n">T_total</span><span class="o">=</span><span class="mi">100</span><span class="p">;</span>


<span class="c1">#standard deviation sigma_f of the discrete white noise proces </span>
<span class="c1"># var(F) = sigma_F^2</span>
<span class="n">sigma_F</span><span class="o">=</span><span class="mi">3</span><span class="p">;</span>


<span class="c1">#set up figure</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">16</span><span class="p">,</span><span class="mi">8</span><span class="p">])</span>

<span class="k">for</span> <span class="n">i_dt</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    
    <span class="c1">#sampling interval</span>
    <span class="n">dt</span><span class="o">=</span><span class="n">dt_vec</span><span class="p">[</span><span class="n">i_dt</span><span class="p">]</span>
    <span class="c1">#time vector</span>
    <span class="n">t</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">T_total</span><span class="p">,</span><span class="n">dt</span><span class="p">)</span>
    
    <span class="c1">#total number of points:</span>
    <span class="n">N</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">T_total</span><span class="o">/</span><span class="n">dt</span><span class="p">);</span>

    <span class="c1">#simulate a white noise process:</span>
    <span class="n">F</span><span class="o">=</span><span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">scale</span><span class="o">=</span><span class="n">sigma_F</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="n">N</span><span class="p">);</span>

    <span class="c1">#compute the spectrum</span>
    <span class="n">out</span><span class="o">=</span><span class="n">mtspec</span><span class="o">.</span><span class="n">MTSpec</span><span class="p">(</span><span class="n">F</span><span class="p">,</span><span class="n">nw</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span><span class="n">kspec</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">freq</span><span class="o">=</span><span class="n">out</span><span class="o">.</span><span class="n">freq</span>
    <span class="n">S_FF</span> <span class="o">=</span><span class="n">out</span><span class="o">.</span><span class="n">spec</span>
    <span class="n">S_FF</span><span class="o">=</span><span class="n">S_FF</span><span class="p">[</span><span class="n">freq</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">freq</span><span class="o">=</span><span class="n">freq</span><span class="p">[</span><span class="n">freq</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">]</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">i_dt</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">F</span><span class="p">,</span><span class="s1">&#39;.-&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\Delta t=$&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">dt</span><span class="p">)</span><span class="o">+</span><span class="sa">r</span><span class="s1">&#39;; $\sigma_F^2=$&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">sigma_F</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span><span class="o">+</span><span class="s1">&#39;; $var(F)$= &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">F</span><span class="p">),</span><span class="mi">2</span><span class="p">)))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="mi">15</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;F&#39;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">i_dt</span><span class="o">+</span><span class="mi">3</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freq</span><span class="p">,</span><span class="n">S_FF</span><span class="p">,</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="n">sigma_x</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">dt</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">freq</span><span class="p">),</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;mean density $\overline{\hat{S_</span><span class="si">{FF}</span><span class="s1">}}$=&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">S_FF</span><span class="p">),</span><span class="mi">2</span><span class="p">)))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$f_N=1/(2\Delta t)=$&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">freq</span><span class="p">),</span><span class="mi">2</span><span class="p">))</span><span class="o">+</span><span class="sa">r</span><span class="s1">&#39;; var$(F)=\int_{-f_N}^</span><span class="si">{f_N}</span><span class="s1"> S_</span><span class="si">{FF}</span><span class="s1">df=$ &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">F</span><span class="p">),</span><span class="mi">2</span><span class="p">)))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">9</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;frequency [1/t]&#39;</span><span class="p">);</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/ab68bda36f69ebf625e5752d98a16f67032c7caa9d24c30de56659cf86ab126c.png" src="../../_images/ab68bda36f69ebf625e5752d98a16f67032c7caa9d24c30de56659cf86ab126c.png" />
</div>
</div>
</section>
<section id="small-delta-t-then-averaging">
<h3>Small <span class="math notranslate nohighlight">\(\Delta t\)</span> then averaging<a class="headerlink" href="#small-delta-t-then-averaging" title="Permalink to this heading">#</a></h3>
<p>A third, more realistic approach would be to use to different timescales
to simulate the fact that we are taking discrete averages of a continuous
process. We would first choose a very small numerical time-step <span class="math notranslate nohighlight">\(\Delta t_{num}\)</span>
at which to discretize the continuous Hasselmann equation, and assume
that the forcing spectrum is zero at frequencies higher than <span class="math notranslate nohighlight">\(f=1/\left(2\Delta t_{N}\right).\)</span>
We would then take block averages of larger <span class="math notranslate nohighlight">\(\Delta t\)</span> intervals</p>
<p>Below I simulate a model using a numerical time-step of <span class="math notranslate nohighlight">\(\Delta t_{num}=1\)</span> meant to represent, for example, using a daily resolution, then take averages of <span class="math notranslate nohighlight">\(\Delta t=7\)</span> days and <span class="math notranslate nohighlight">\(\Delta t=28\)</span> days to represent using weekly or monthly averaged data.</p>
<p>Notice that this scenario ends up being very similar to the first proposed way, of assuming the spectral density <span class="math notranslate nohighlight">\(S_FF\)</span> is zero at frequencies higher than the Nyquist frequency. This is because time-averaging is a form of a low-pass filter. In fact, moving average and sampling imparts a slightly different spectrum than a pure low-pass filter that sets all spectral power to zero above <span class="math notranslate nohighlight">\(1/(2\Delta t)\)</span> and keeps them the same at lower frequencies. But the details of low-pass filtering go beyond the scope of these notes.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Spectral density</span>
<span class="n">specdens</span><span class="o">=</span><span class="mf">1.5</span><span class="p">;</span>

<span class="c1"># original sampling interval (time-step)</span>
<span class="n">dt_num</span><span class="o">=</span><span class="mi">1</span>

<span class="c1"># Total Simulation time</span>
<span class="n">T_total</span><span class="o">=</span><span class="mi">7</span><span class="o">*</span><span class="mi">4</span><span class="o">*</span><span class="mi">20</span><span class="p">;</span>

<span class="n">N</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">T_total</span><span class="o">/</span><span class="n">dt_num</span><span class="p">);</span>

<span class="c1"># A vector of three different sampling intervals</span>
<span class="n">dt_vec</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="o">*</span><span class="mi">4</span><span class="p">]</span>

<span class="c1">#set up figure</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">])</span>

<span class="c1">#simulate one process</span>
<span class="n">var_F</span><span class="o">=</span><span class="n">specdens</span><span class="o">/</span><span class="n">dt_orig</span>
<span class="n">sigma_F</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">var_F</span><span class="p">);</span>
<span class="n">F_orig</span><span class="o">=</span><span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">scale</span><span class="o">=</span><span class="n">sigma_F</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="n">N</span><span class="p">);</span>


<span class="k">for</span> <span class="n">i_dt</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    
    <span class="c1">#take averages of lenth dt</span>
    <span class="n">dt</span><span class="o">=</span><span class="n">dt_vec</span><span class="p">[</span><span class="n">i_dt</span><span class="p">]</span>

    <span class="c1">#how many samples go in an average?</span>
    <span class="n">dn</span><span class="o">=</span><span class="n">dt</span><span class="o">/</span><span class="n">dt_orig</span>
    
    <span class="c1">#locs=np.arange(0,N,dn).astype(&#39;int&#39;)</span>
    <span class="c1">#coarse time vector</span>
    <span class="n">t</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">T_total</span><span class="p">,</span><span class="n">dt_vec</span><span class="p">[</span><span class="n">i_dt</span><span class="p">])</span>
    
    <span class="c1">#take block averages</span>
    <span class="n">F</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">F_orig</span><span class="p">,[</span><span class="nb">int</span><span class="p">(</span><span class="n">N</span><span class="o">/</span><span class="n">dn</span><span class="p">),</span><span class="nb">int</span><span class="p">(</span><span class="n">dn</span><span class="p">)])</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">);</span> 

    <span class="c1">#compute the spectrum</span>
    <span class="n">out</span><span class="o">=</span><span class="n">mtspec</span><span class="o">.</span><span class="n">MTSpec</span><span class="p">(</span><span class="n">F</span><span class="p">,</span><span class="n">nw</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span><span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span><span class="n">kspec</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">iadapt</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">freq</span><span class="o">=</span><span class="n">out</span><span class="o">.</span><span class="n">freq</span>
    <span class="n">S_FF</span><span class="o">=</span><span class="n">out</span><span class="o">.</span><span class="n">spec</span>
    <span class="n">S_FF</span><span class="o">=</span><span class="n">S_FF</span><span class="p">[</span><span class="n">freq</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">freq</span><span class="o">=</span><span class="n">freq</span><span class="p">[</span><span class="n">freq</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">]</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">F</span><span class="p">,</span><span class="s1">&#39;.-&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="n">i_dt</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">markersize</span><span class="o">=</span><span class="mi">7</span><span class="o">*</span><span class="p">(</span><span class="n">i_dt</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\Delta t=$ &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">dt</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freq</span><span class="p">,</span><span class="n">S_FF</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="n">specdens</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">freq</span><span class="p">),</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;process $S_</span><span class="si">{ff}</span><span class="s1">$&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mf">1E-1</span><span class="p">,</span><span class="mf">1E1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mf">1E-3</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/b94ed0ff71b191d0395b55331c111239bbfa3eba50c1c0cc521d816c3da7b12a.png" src="../../_images/b94ed0ff71b191d0395b55331c111239bbfa3eba50c1c0cc521d816c3da7b12a.png" />
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./content/Hasselmann"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="2_Hasselmann_model.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">2. The Hasselmann model</p>
      </div>
    </a>
    <a class="right-next"
       href="4_Theory.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">4. Theoretical Solutions</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-problem-with-continuous-white-noise">The problem with continuous white noise</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#nyquist-frequency-and-a-truncated-white-noise-spectrum">Nyquist frequency and a truncated white noise spectrum:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#setting-the-variance-in-a-simulation-fixing-spetral-density-tilde-s-f">Setting the variance in a simulation: Fixing spetral density <span class="math notranslate nohighlight">\(\tilde s_F\)</span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alternatives">Alternatives</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fixing-sigma-f-delta-t-is-sampling-time">Fixing <span class="math notranslate nohighlight">\(\sigma_{F}\)</span> (<span class="math notranslate nohighlight">\(\Delta t\)</span> is sampling time)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#small-delta-t-then-averaging">Small <span class="math notranslate nohighlight">\(\Delta t\)</span> then averaging</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Cristian Proistosescu
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>